import{Cc as l,E as p,H as h,Rc as g,i as c,rb as a,sb as d,t as u}from"./chunk-QIF64ZIK.js";var f="cart",v=(()=>{let i=class i{constructor(){this._cart$=new c(null),this.cart$=this._cart$.asObservable(),this.initCartLocalStorage()}initCartLocalStorage(){let t=this._getCart();t?this._saveCart(t):this._saveCart([])}addCartItem(t){let e=this._getCart();if(e)if(e.length){let r=e.findIndex(s=>s.product===t.product);if(r===-1)e.push(t),this._saveCart(e);else{let s=e[r];s.quantity=s.quantity+t.quantity,e.splice(r,1,s),this._saveCart(e)}}else e.push(t),this._saveCart(e)}editCartItem(t,e){let r=this._getCart();if(r&&r.length){let s=r.findIndex(n=>n.product===t);s!==-1&&(r[s].quantity=e,this._saveCart(r))}}deleteCartItem(t){let e=this._getCart();if(e&&e.length){let r=e.findIndex(s=>s.product===t);r!==-1&&(e.splice(r,1),this._saveCart(e))}}clearCart(){this._saveCart([])}get cartCount(){return this._cart$.value?this._cart$.value.length:null}_saveCart(t){localStorage.setItem(f,JSON.stringify(t)),this._cart$.next(t)}_getCart(){return JSON.parse(localStorage.getItem(f))}};i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=p({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var b=(()=>{let i=class i{constructor(t,e){this.http=t,this.authService=e,this._filterBy$=new c({categories:[],name:""}),this.filterBy$=this._filterBy$.asObservable(),this._products$=new c({products:[],pageCount:0}),this.products$=this._products$.asObservable(),this.apiUrl=l.API_URL}getProducts({currPage:t,pageSize:e}={}){let r=new a;this._filterBy$.value.categories.length&&(r=r.append("categories",this._filterBy$.value.categories.join(","))),this._filterBy$.value.name&&(r=r.append("products",this._filterBy$.value.name)),t&&e&&(r=r.append("currPage",t),r=r.append("pageSize",e)),this.http.get(`${this.apiUrl}products`,{params:r}).pipe(u(1)).subscribe({next:n=>{this._setProducts(n)},error:n=>{console.error("err",n)}})}_setProducts(t){this._products$.next(t)}getProductById(t){return this.http.get(`${this.apiUrl}products/${t}`)}addProduct(t){let e=new a().append("isLoginFast",this.authService.getIsLoginFast());return this.http.post(`${this.apiUrl}products`,t,{params:e})}editProduct(t){let e=new a().append("isLoginFast",this.authService.getIsLoginFast());return this.http.put(`${this.apiUrl}products/${t.get("id")}`,t,{params:e})}editProductGallery(t,e){let r=new a().append("isLoginFast",this.authService.getIsLoginFast());return this.http.put(`${this.apiUrl}products/gallery-images/${e}`,t,{params:r})}deleteProduct(t){let e=new a().append("isLoginFast",this.authService.getIsLoginFast());return this.http.delete(`${this.apiUrl}products/${t}`,{params:e})}getProductsCount(){let t=new a().append("isLoginFast",this.authService.getIsLoginFast());return this.http.get(`${this.apiUrl}products/get/count`,{params:t})}getFeaturedProducts(t){return this.http.get(`${this.apiUrl}products/get/featured/${t}`)}setFilterBy(t){this._filterBy$.next(t)}getProductStatistics(){let t=new a().append("isLoginFast",this.authService.getIsLoginFast());return this.http.get(`${this.apiUrl}products/get/statistics`,{params:t})}};i.\u0275fac=function(e){return new(e||i)(h(d),h(g))},i.\u0275prov=p({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();export{v as a,b};
