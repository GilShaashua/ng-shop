import{a as _e,b as Se,c as xe}from"./chunk-W6PPWDBA.js";import{a as Q,b as Ce}from"./chunk-CXDOML6S.js";import{$a as g,A as W,Aa as q,Ab as M,Ba as I,Ca as f,Cb as pe,Cc as ge,Db as de,E as oe,H as J,Hb as R,K as S,Kb as j,La as N,Lb as h,Ma as s,Mb as L,Na as C,Nb as U,Oa as w,Pa as ae,Pb as $,Q as x,Qb as ue,R as y,Rb as A,Rc as ve,Sb as z,Tb as he,Ua as E,Ub as fe,Vb as G,W as K,Wa as se,Xb as Y,_ as B,aa as c,ab as v,ba as u,bb as D,cb as ce,f as T,h as re,jb as me,k as O,kb as V,la as d,lb as F,na as m,ob as k,pb as b,rb as _,sb as le,ua as n,va as t,wa as p,z as ne}from"./chunk-QIF64ZIK.js";var Z=(()=>{let a=class a{constructor(r,e){this.http=r,this.authService=e,this.apiUrl=ge.API_URL}getOrders(){let r=new _().append("isLoginFast",this.authService.getIsLoginFast());return this.http.get(`${this.apiUrl}orders`,{params:r})}getOrderById(r){let e=new _().append("isLoginFast",this.authService.getIsLoginFast());return this.http.get(`${this.apiUrl}orders/${r}`,{params:e})}addOrder(r){return this.http.post(`${this.apiUrl}orders`,r)}editOrder(r){let e=new _().append("isLoginFast",this.authService.getIsLoginFast());return this.http.put(`${this.apiUrl}orders/${r.id}`,r,{params:e})}deleteOrder(r){let e=new _().append("isLoginFast",this.authService.getIsLoginFast());return this.http.delete(`${this.apiUrl}orders/${r}`,{params:e})}getOrdersCount(){let r=new _().append("isLoginFast",this.authService.getIsLoginFast());return this.http.get(`${this.apiUrl}orders/get/count`,{params:r})}getTotalSales(){let r=new _().append("isLoginFast",this.authService.getIsLoginFast());return this.http.get(`${this.apiUrl}orders/get/total-sales`,{params:r})}getOrderStatistics({dateOrdered:r}){let e=new _;return e=e.append("dateOrdered",r),e=e.append("isLoginFast",this.authService.getIsLoginFast()),this.http.get(`${this.apiUrl}orders/get/statistics`,{params:e})}getOrdersYears(){let r=new _().append("isLoginFast",this.authService.getIsLoginFast());return this.http.get(`${this.apiUrl}orders/get/years`,{params:r})}getTotalSalesStatistics({dateOrdered:r}){let e=new _().set("dateOrdered",r);return e=e.append("isLoginFast",this.authService.getIsLoginFast()),this.http.get(`${this.apiUrl}orders/get/total-sales-statistics`,{params:e})}};a.\u0275fac=function(e){return new(e||a)(J(le),J(ve))},a.\u0275prov=oe({token:a,factory:a.\u0275fac,providedIn:"root"});let i=a;return i})();function Pe(i,a){i&1&&(n(0,"small",36),s(1,"Name is requried!"),t())}function Te(i,a){i&1&&(n(0,"small",36),s(1,"Email is requried!"),t())}function qe(i,a){i&1&&(n(0,"small",36),s(1,"Must be example@example.com"),t())}function we(i,a){i&1&&(n(0,"small",36),s(1,"Phone is requried!"),t())}function Oe(i,a){i&1&&(n(0,"small",36),s(1,"Street is requried!"),t())}function Be(i,a){i&1&&(n(0,"small",36),s(1,"Apartment is requried!"),t())}function Ne(i,a){i&1&&(n(0,"small",36),s(1,"Zip is requried!"),t())}function De(i,a){i&1&&(n(0,"small",36),s(1,"City is requried!"),t())}function Ve(i,a){i&1&&(n(0,"small",36),s(1,"Country is requried!"),t())}function Me(i,a){i&1&&p(0,"i",37)}function Re(i,a){if(i&1){let o=q();n(0,"section",2)(1,"h1"),s(2,"Checkout"),t(),n(3,"div",3)(4,"form",4)(5,"div",5)(6,"label",6),s(7,"Name"),t(),p(8,"input",7),d(9,Pe,2,0,"small",8),t(),n(10,"div",9)(11,"label",10),s(12,"Email"),t(),p(13,"input",11),d(14,Te,2,0,"small",8)(15,qe,2,0,"small",8),t(),n(16,"div",12)(17,"label",13),s(18,"Phone"),t(),p(19,"input",14),d(20,we,2,0,"small",8),t(),n(21,"div",15)(22,"label",16),s(23,"Street"),t(),p(24,"input",17),d(25,Oe,2,0,"small",8),t(),n(26,"div",18)(27,"label",19),s(28,"Apartment"),t(),p(29,"input",20),d(30,Be,2,0,"small",8),t(),n(31,"div",21)(32,"label",22),s(33,"Zip"),t(),p(34,"input",23),d(35,Ne,2,0,"small",8),t(),n(36,"div",24)(37,"label",25),s(38,"City"),t(),p(39,"input",26),d(40,De,2,0,"small",8),t(),n(41,"div",27)(42,"label",28),s(43,"Country"),t(),p(44,"p-dropdown",29),d(45,Ve,2,0,"small",8),t()(),n(46,"div",30)(47,"h2"),s(48,"Order Summary"),t(),n(49,"div",31)(50,"span"),s(51,"Items Price"),t(),n(52,"span"),s(53),g(54,"currency"),t()(),n(55,"div",32)(56,"span"),s(57,"Packing & Shipping"),t(),n(58,"span"),s(59,"Free"),t()(),n(60,"div",33)(61,"span"),s(62,"Total Price"),t(),n(63,"span"),s(64),g(65,"currency"),t()(),n(66,"button",34),I("click",function(){x(o);let e=f();return y(e.onPlaceOrder())}),n(67,"span"),s(68," Place Order"),t(),d(69,Me,1,0,"i",35),t()()()()}if(i&2){let o=f();c(4),m("formGroup",o.form),c(5),m("ngIf",o.controlsForm.name.hasError("required")&&o.isSubmitted),c(5),m("ngIf",o.controlsForm.email.hasError("required")&&o.isSubmitted),c(),m("ngIf",o.controlsForm.email.hasError("email")&&o.isSubmitted),c(5),m("ngIf",o.controlsForm.phone.hasError("required")&&o.isSubmitted),c(5),m("ngIf",o.controlsForm.street.hasError("required")&&o.isSubmitted),c(5),m("ngIf",o.controlsForm.apartment.hasError("required")&&o.isSubmitted),c(5),m("ngIf",o.controlsForm.zip.hasError("required")&&o.isSubmitted),c(5),m("ngIf",o.controlsForm.city.hasError("required")&&o.isSubmitted),c(4),m("options",o.countries)("filter",!0),c(),m("ngIf",o.controlsForm.country.hasError("required")&&o.isSubmitted),c(8),C(v(54,15,o.totalPrice)),c(11),C(v(65,17,o.totalPrice)),c(5),m("ngIf",o.isProccessing)}}function je(i,a){i&1&&(n(0,"div",38),p(1,"i",37),t())}var ee=(()=>{let a=class a{constructor(r,e,l,P,te,ie,Fe){this.usersService=r,this.cartService=e,this.productsService=l,this.ordersService=P,this.formBuilder=te,this.route=ie,this.router=Fe,this.subscriptionSubject=new re,this.totalPrice=0,this.isSubmitted=!1,this.isProccessing=!1,this.form=this.formBuilder.group({name:["",[h.required]],email:["",[h.required,h.email]],phone:["",[h.required]],street:["",[h.required]],apartment:["",[h.required]],zip:["",[h.required]],city:["",[h.required]],country:["",[h.required]]})}ngOnInit(){this._getCountries(),this._getCart(),this._checkParams()}onPlaceOrder(){if(this.isSubmitted=!0,this.form.invalid)return;if(!this.cart.length){this.router.navigateByUrl("/");return}this.isProccessing=!0;let e={id:"",orderItems:this.cart.map(l=>({id:"",product:l.product.id,quantity:l.quantity})),shippingAddress1:this.controlsForm.street.value,shippingAddress2:this.controlsForm.apartment.value,city:this.controlsForm.city.value,zip:this.controlsForm.zip.value,country:this.controlsForm.country.value,phone:this.controlsForm.phone.value,status:"0",user:this.userId||"66424b69b7ec423fca98a2a1",dateOrdered:Date.now()+""};this.ordersService.addOrder(e).subscribe({next:l=>{this.cartService.clearCart(),this.router.navigateByUrl(`thank-you/${l.id}`)},error:l=>{console.error("Cannot add order",l)}})}_getCountries(){let r=this.usersService.getCountries();this.countries=r}_getCart(){this.cartService.cart$.pipe(ne(r=>T(this,null,function*(){if(r){let e=r.map(l=>T(this,null,function*(){let P=this.productsService.getProductById(l.product);return{product:yield O(P),quantity:l.quantity}}));return yield Promise.all(e)}return null})),W(this.subscriptionSubject)).subscribe({next:r=>{if(this.cart=r||[],!this.cart.length){this.router.navigateByUrl("/");return}this._getTotalPrice()},error:r=>{console.error("Cannot get cart",r)}})}_checkParams(){this.route.params.pipe(W(this.subscriptionSubject)).subscribe({next:r=>T(this,null,function*(){if(r.userId)try{let e=yield O(this.usersService.getUserById(r.userId));e&&(this.userId=e.id,this.form.patchValue(e))}catch(e){console.error("Cannot get user",e)}}),error:r=>{console.error("Cannot get params",r)}})}_getTotalPrice(){this.totalPrice=this.cart.reduce((r,e)=>r+e.product.price*e.quantity,0)}get controlsForm(){return this.form.controls}ngOnDestroy(){this.subscriptionSubject.next(null),this.subscriptionSubject.complete()}};a.\u0275fac=function(e){return new(e||a)(u(_e),u(Q),u(Ce),u(Z),u(G),u(M),u(pe))},a.\u0275cmp=S({type:a,selectors:[["orders-checkout-page"]],standalone:!0,features:[E],decls:3,vars:2,consts:[["loader",""],["class","checkout-page",4,"ngIf","ngIfElse"],[1,"checkout-page"],[1,"inner-container"],[3,"formGroup"],[1,"input","name"],["for","name"],["formControlName","name","type","text","name","name","id","name"],["class","p-error",4,"ngIf"],[1,"input","email"],["for","email"],["formControlName","email","type","email","name","email","id","email"],[1,"input","phone"],["for","phone"],["formControlName","phone","type","tel","name","phone","id","phone"],[1,"input","street"],["for","street"],["formControlName","street","type","text","name","street","id","street"],[1,"input","apartment"],["for","apartment"],["formControlName","apartment","type","text","name","apartment","id","apartment"],[1,"input","zip"],["for","zip"],["formControlName","zip","type","text","name","zip","id","zip"],[1,"input","city"],["for","city"],["formControlName","city","type","text","name","city","id","city"],[1,"country"],["for","country"],["formControlName","country","optionLabel","name","optionValue","id","filterBy","name","placeholder","Select a country",3,"options","filter"],[1,"order-summary"],[1,"items-price"],[1,"packing-shipping"],[1,"total-price"],[1,"btn-place-order",3,"click"],["class","pi pi-spin pi-spinner",4,"ngIf"],[1,"p-error"],[1,"pi","pi-spin","pi-spinner"],[1,"loader"]],template:function(e,l){if(e&1&&d(0,Re,70,19,"section",1)(1,je,2,0,"ng-template",null,0,D),e&2){let P=N(2);m("ngIf",l.countries&&l.cart)("ngIfElse",P)}},dependencies:[b,F,k,R,xe,Se,Y,$,j,L,U,A,z]});let i=a;return i})();function Le(i,a){if(i&1&&(n(0,"li",8)(1,"div",9)(2,"h2"),s(3),t(),p(4,"img",10),t(),n(5,"div",11)(6,"p")(7,"span"),s(8,"Quantity"),t(),s(9),t(),n(10,"p")(11,"span"),s(12,"Subtotal"),t(),s(13),g(14,"currency"),t()()()),i&2){let o=a.$implicit;c(3),C(o.product.name),c(),m("src",o.product.image,B),c(5),w(" ",o.quantity,""),c(4),w(" ",v(14,4,o.product.price*o.quantity)," ")}}function Ue(i,a){if(i&1&&(n(0,"section",2)(1,"div",3)(2,"div",4)(3,"h1"),s(4,"Thank you for shopping with us"),t(),n(5,"p"),s(6," We have recieved you order and it will be delivered in the next 3 days. "),t()(),n(7,"button",5),s(8,"Back to shop"),t()(),n(9,"ul"),d(10,Le,15,6,"li",6),t(),n(11,"div",7)(12,"span"),s(13,"Total Price"),t(),s(14),g(15,"currency"),t()()),i&2){let o=f();c(10),m("ngForOf",o.order.orderItems)("ngForTrackBy",o.trackByOrderItem),c(4),w(" ",v(15,3,o.order.totalPrice)," ")}}function $e(i,a){i&1&&(n(0,"div",12),p(1,"i",13),t())}var Ie=(()=>{let a=class a{constructor(r,e,l){this.changeDetectorRef=r,this.route=e,this.ordersService=l}ngOnInit(){this._checkParams()}_checkParams(){this.paramsSubs=this.route.params.subscribe(r=>T(this,null,function*(){if(r.orderId){let e=this.ordersService.getOrderById(r.orderId),l=yield O(e);this.order=l,this.changeDetectorRef.detectChanges()}}))}trackByOrderItem(r,e){return e.id}ngOnDestroy(){this.paramsSubs?.unsubscribe()}};a.\u0275fac=function(e){return new(e||a)(u(ce),u(M),u(Z))},a.\u0275cmp=S({type:a,selectors:[["orders-thank-you"]],standalone:!0,features:[E],decls:3,vars:2,consts:[["loader",""],["class","thank-you-container",4,"ngIf","ngIfElse"],[1,"thank-you-container"],[1,"header"],[1,"heading"],["routerLink","/",1,"btn-back"],["class","order-item",4,"ngFor","ngForOf","ngForTrackBy"],[1,"total-price"],[1,"order-item"],[1,"inner-container"],["alt","product",3,"src"],[1,"inner-container2"],[1,"loader"],[1,"pi","pi-spin","pi-spinner"]],template:function(e,l){if(e&1&&d(0,Ue,16,5,"section",1)(1,$e,2,0,"ng-template",null,0,D),e&2){let P=N(2);m("ngIf",l.order)("ngIfElse",P)}},dependencies:[b,V,F,k,R,de],changeDetection:0});let i=a;return i})();var xt=[{path:"checkout",component:ee,title:"Checkout | ngShop"},{path:"checkout/:userId",component:ee,title:"Checkout | ngShop"},{path:"thank-you/:orderId",component:Ie,title:"Thank You | ngShop"}];function Ae(i,a){i&1&&(n(0,"small"),s(1," Quantity is required! "),t())}function ze(i,a){i&1&&(n(0,"small"),s(1," Minimum is 1! "),t())}function Ge(i,a){i&1&&(n(0,"small"),s(1," Maximum is 99! "),t())}function Ye(i,a){if(i&1){let o=q();n(0,"li",1)(1,"div",2),p(2,"img",3),n(3,"div",4)(4,"div",5),s(5),t(),n(6,"div",6),s(7),g(8,"currency"),t(),n(9,"button",7),I("click",function(){x(o);let e=f();return y(e.onDeleteCartItem(e.controls.product.value.id))}),p(10,"i",8),t()()(),n(11,"form",9)(12,"div",10)(13,"input",11),I("input",function(){x(o);let e=f();return y(e.onChangeQuantity(e.controls.product.value.id))}),t(),n(14,"p"),s(15," Subtotal: "),n(16,"span"),s(17),g(18,"currency"),t()()(),d(19,Ae,2,0,"small",12)(20,ze,2,0,"small",12)(21,Ge,2,0,"small",12),t()()}if(i&2){let o=f();c(2),m("src",o.controls.product.value.image,B),c(3),C(o.cartItem.product.name),c(2),w(" ",v(8,8,o.cartItem.product.price)," "),c(4),m("formGroup",o.cartItemRF),c(6),C(v(18,10,o.controls.product.value.price*o.controls.quantity.value)),c(2),m("ngIf",o.controls.quantity.hasError("required")),c(),m("ngIf",o.controls.quantity.hasError("min")),c(),m("ngIf",o.controls.quantity.hasError("max"))}}var Ee=(()=>{let a=class a{constructor(r,e){this.formBuilder=r,this.cartService=e}ngOnInit(){this.cartItemRF=this.formBuilder.group({quantity:[this.cartItem.quantity,[h.required,h.min(1),h.max(99)]],product:[this.cartItem.product,[h.required]]})}get controls(){return this.cartItemRF.controls}onChangeQuantity(r){this.cartItemRF.invalid||this.cartService.editCartItem(r,this.controls.quantity.value)}onDeleteCartItem(r){this.cartService.deleteCartItem(r)}};a.\u0275fac=function(e){return new(e||a)(u(G),u(Q))},a.\u0275cmp=S({type:a,selectors:[["orders-cart-item"]],hostAttrs:[1,"cart-item-host"],inputs:{cartItem:"cartItem"},standalone:!0,features:[E],decls:1,vars:1,consts:[["class","cart-item",4,"ngIf"],[1,"cart-item"],[1,"column1"],["alt","product",3,"src"],[1,"details"],[1,"product-name"],[1,"product-price"],[1,"btn-delete-product",3,"click"],[1,"pi","pi-trash"],[1,"column2",3,"formGroup"],[1,"inner-container"],["formControlName","quantity","type","number","name","quantity","id","quantity","min","1","max","99",3,"input"],[4,"ngIf"]],template:function(e,l){e&1&&d(0,Ye,22,12,"li",0),e&2&&m("ngIf",l.cartItemRF)},dependencies:[b,F,k,Y,$,j,ue,L,U,fe,he,A,z]});let i=a;return i})();var Qe=i=>({open:i});function He(i,a){if(i&1&&p(0,"orders-cart-item",15),i&2){let o=a.$implicit;m("cartItem",o)}}function Ze(i,a){if(i&1){let o=q();n(0,"div",1)(1,"div",2)(2,"div",3)(3,"h1"),s(4,"My Cart"),t(),n(5,"p"),s(6),t()(),n(7,"button",4),I("click",function(){x(o);let e=f();return y(e.onCloseCart.emit(!1))}),p(8,"i",5),t()(),n(9,"ul"),d(10,He,1,1,"orders-cart-item",6),t(),n(11,"div",7)(12,"div",3)(13,"div",8)(14,"span"),s(15,"Items Price"),t(),n(16,"span"),s(17),g(18,"currency"),t()(),n(19,"div",9)(20,"span"),s(21,"Packing & Shipping"),t(),n(22,"span",10),s(23,"Free"),t()()(),n(24,"div",11)(25,"div",12)(26,"span"),s(27,"Total Price"),t(),n(28,"span"),s(29),g(30,"currency"),t()(),n(31,"button",13),I("click",function(){x(o);let e=f();return y(e.onCheckout.emit())}),p(32,"i",14),s(33," Checkout "),t()()()()}if(i&2){let o=f();m("ngClass",se(11,Qe,o.isCartShown)),c(6),ae("",o.cart.length," ",o.cart.length===1?"item":"items",""),c(4),m("ngForOf",o.cart)("ngForTrackBy",o.trackByCartItem),c(7),C(v(18,7,o.totalPrice)),c(12),C(v(30,9,o.totalPrice))}}var Nt=(()=>{let a=class a{constructor(){this.onCloseCart=new K,this.onCheckout=new K}trackByCartItem(r,e){return e.product.id}};a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=S({type:a,selectors:[["orders-cart"]],hostAttrs:[1,"cart-host"],inputs:{cart:"cart",isCartShown:"isCartShown",totalPrice:"totalPrice"},outputs:{onCloseCart:"onCloseCart",onCheckout:"onCheckout"},standalone:!0,features:[E],decls:1,vars:1,consts:[["class","cart",3,"ngClass",4,"ngIf"],[1,"cart",3,"ngClass"],[1,"header"],[1,"inner-container"],[1,"btn-close",3,"click"],[1,"pi","pi-times"],[3,"cartItem",4,"ngFor","ngForOf","ngForTrackBy"],[1,"footer"],[1,"items-price"],[1,"packing-shipping"],[1,"free"],[1,"checkout"],[1,"total-price"],[1,"btn-checkout",3,"click"],[1,"pi","pi-shopping-cart"],[3,"cartItem"]],template:function(e,l){e&1&&d(0,Ze,34,13,"div",0),e&2&&m("ngIf",l.cart)},dependencies:[b,me,V,F,k,Ee],changeDetection:0});let i=a;return i})();export{ee as a,Ie as b,xt as c,Ee as d,Nt as e};
